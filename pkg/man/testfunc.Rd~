\name{testfunc}
\alias{testfunc}
\title{
  Differential testing function
}
\description{
  pick up the test for differential methylation testing 
}

\usage{
testfunc(eset = eset, concov = c("ON", "OFF"), testmethod = c("wilcox", "limma", "pooled", "satterthwaite"), Padj = c("holm", "hochberg", "hommel", "bonferroni", "BH", "BY", "fdr", "none"), grouplev = grouplev, gcase = "g1", gcontrol = "g2")
}

\arguments{
  \item{eset}{
a beta matrix
}
\item{concov}{
  if "ON", covariates is continuous variable,"grouplev" should be the
  continuous observation. 

}
  \item{testmethod}{
  Wilcoxon rank-sum test (default), Student's t-test and empirical Bayes statistics (G. K. Smyth, 2004).
}
  \item{Padj}{
specify which method applied for multiple testing correction.
}
  \item{grouplev}{
specify the vector for covariate:if concov is "ON", this should be the
  continuous values, if concov is "OFF", this should be categorical values. 
}
\item{gcase}{
   specify the string name of phenotype in the case group
}
\item{gcontrol}{
  specify the string name of phenotype in the case group
}
}

}
\value{
return a matrix with "P-Value", "Adjust Pval","beta-Difference" in columns for each sites or annotated region
}
\author{
Dan Wang, Li Yang, Qiang Hu,Dominic J Smiraglia,Song Liu
Maintainer: Dan Wang <wangdan412@gmail.com>
}
\seealso{
  \code{\link{IMA.methy450R}},\code{\link{regionswrapper}},\code{\link{IMA.methy450PP}},\code{\link{sigtest}},\code{\link{sumregionfun}}
}
\examples{
data(fullannotInd)
indlists = c("BRCA1", "MLH1", "CCNE1", "PTEN", "PALB2")
index = match("TSS1500Ind",names(fullannot))
annot = fullannot[[index]]
index = match(indlists,names(annot))
indexlist = annot[index]     
#beta = data@bmatrix;
#eset = sumregionfun(indexlist,beta,"mean");
#testfunc(eset,concov = "OFF",testmethod="limma",Padj="BH",gcase ="g2",gcontrol="g1",grouplev=grouplev)
}
